# This "input" configures a global authorization rule to enable public access to
# all models in this schema. Learn more about authorization rules here: https://docs.amplify.aws/cli/graphql/authorization-rules
input AMPLIFY { globalAuthRule: AuthRule = { allow: public } } # FOR TESTING ONLY!


type User @model {
  email: String! @index(queryField: "getUserByEmail")
  phone: Int
  phoneId: String
  postalCode: String
  province: Province!
  userCategoryTopics: [UserCategoryTopic] @hasMany
}

type Category @model {
  acronym: String! @index(queryField: "getCategoryByAcronym")
  title: String!
  description: String
  categoryTopic: [CategoryTopic] @hasMany
}

type Topic @model {
  acronym: String! @index(queryField: "getTopicByAcronym")
  # add name field?
  categoryTopic: [CategoryTopic] @hasMany
}


# relations

type CategoryTopic @model {
  # (sortKeyFields: ["categoryId","topicId"])
  categoryId: String! @index(queryField: "getCatTopicByCatId")
  category: Category! @belongsTo(fields: ["categoryId"])
  topicId: String!
  topic: Topic! @belongsTo(fields: ["topicId"])
  userCategoryTopics: [UserCategoryTopic] @hasMany
}

type UserCategoryTopic @model {
  # (sortKeyFields: ["userId", "categoryTopicId"])
  userId: String! @index(queryField: "getUserCatTopicByUserId")
  user: User! @belongsTo(fields: ["userId"])
  categoryTopicId: String!
  categoryTopic: CategoryTopic! @belongsTo(fields: ["categoryTopicId"])
  email: Boolean!
  sms: Boolean!
}

enum Province {
  AB
  BC
  MB
  NB
  NL
  NT
  NS
  NU
  ON
  PE
  QC
  SK
  YT
}