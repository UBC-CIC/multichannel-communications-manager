# This "input" configures a global authorization rule to enable public access to
# all models in this schema. Learn more about authorization rules here: https://docs.amplify.aws/cli/graphql/authorization-rules
input AMPLIFY {
  globalAuthRule: AuthRule = { allow: public }
} # FOR TESTING ONLY!
type Category {
  category_id: Int!
  acronym: String!
  title: String!
  description: String
}

type Topic {
  topic_id: Int!
  acronym: String!
}

type CategoryTopic {
  categorytopic_id: Int!
  category_acronym: String!
  topic_acronym: String!
}

type UserCategoryTopic {
  user_id: Int!
  categorytopic_id: Int!
  email: Boolean!
  sms: Boolean
}

type User {
  user_id: Int!
  email_address: String!
  phone_address: Int
  phone_id: String
  postal_code: String
  province: Province!
}

type Mutation {
  createUser(
    email_address: String!
    phone_address: Int
    postal_code: String
    province: Province!
  ): User
  updateUser(
    user_id: Int!
    email_address: String
    phone: Int
    phone_id: Int
    postal_code: String
    province: Province
  ): User
  deleteUser(user_id: Int!): String

  createCategory(
    acronym: String!
    title: String!
    description: String
  ): Category
  updateCategory(
    category_id: Int!
    acronym: String
    title: String
    description: String
  ): Category
  # TODO: delete or archive?
  deleteCategory(category_id: Int!): String

  createTopic(acronym: String!): Topic
  updateTopic(topic_id: Int!, acronym: String): Topic
  deleteTopic(topic_id: Int!): String
  addTopicToCategory(
    category_acronym: String!
    topic_acronym: String!
  ): CategoryTopic
  deleteCategoryTopic(category_acronym: String!, topic_acronym: String!): String
  userFollowCategoryTopic(
    user_id: Int!
    category_acronym: String!
    topic_acronym: String!
    email: Boolean!
    sms: Boolean!
  ): UserCategoryTopic
  userUnfollowCategoryTopic(
    user_id: Int!
    category_acronym: String!
    topic_acronym: String!
  ): User
}

type Query {
  getUserById(user_id: Int!): User
  getUserByEmail(user_email: String!): User
  getUserCategoryTopicByUserId(user_id: String!): [CategoryTopic]
  getCategoryByAcronym(acronym: String!): Category
  getTopicsOfCategoryByAcronym(category_acronym: String!): [Topic]
  getTopicByAcronym(topic_acronym: String!): Topic
}

schema {
  query: Query
  mutation: Mutation
}

enum Province {
  AB
  BC
  MB
  NB
  NL
  NT
  NS
  NU
  ON
  PE
  QC
  SK
  YT
}
